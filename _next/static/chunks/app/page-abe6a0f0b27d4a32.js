(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{397:function(e,t,r){Promise.resolve().then(r.bind(r,5674))},5674:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return z}});var n=r(7437),i=r(2265);function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e.vertices.find(e=>e.id===t))return e;e.vertices.push({id:t,label:r})}let o=(e,t)=>{let r={directed:t,vertices:[],edges:[]},n=e.split("\n");var i=0;for(let e of n){let t=()=>{let t=/^\s*(-?\d+)\s*(?::(.*))?\s*$/,n=e.match(t);if(null!==n){console.log(n);let[,e,t]=n;r.vertices.some(t=>t.id===parseInt(e))?function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.vertices.find(e=>e.id===t);void 0!==n&&(n.label=r)}(r,parseInt(e),t):s(r,parseInt(e),t)}},n=()=>{let t=/^\s*(-?\d+)\s+(-?\d+)\s*$/,n=e.match(t);if(null!==n){var o,l,d;let[,e,t]=n;o=i++,l=parseInt(e),d=parseInt(t),s(r,l),s(r,d),r.edges.push({id:o,from:l,to:d}),console.log(e,t)}};t(),n()}return r};function l(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:s,inputBoxText:l,setInputBoxText:d}=(0,i.useContext)(k);(0,i.useEffect)(()=>{t(o(l,e.directed))},[l]);let c=r=>{l!==r.target.value&&(d(r.target.value),t(o(r.target.value,e.directed)))};return(0,n.jsx)("div",{className:"h-[80vh]",children:(0,n.jsx)("textarea",{className:"border-solid border-2 resize-none h-full m-2 p-2",value:l,onChange:e=>c(e)})})}class d{add(e){return d.add(this,e)}sub(e){return d.sub(this,e)}norm(){return d.norm(this)}scale(e){return d.scale(this,e)}normalize(){return d.normalize(this)}scaleToLength(e){return d.scaleToLength(this,e)}static add(e,t){return new d(e.x+t.x,e.y+t.y)}static sub(e,t){return new d(e.x-t.x,e.y-t.y)}static norm(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static scale(e,t){return new d(e.x*t,e.y*t)}static normalize(e){return 1e-9>=e.norm()?new d(0,0):d.scale(e,1/d.norm(e))}static scaleToLength(e,t){return d.scale(d.normalize(e),t)}constructor(e,t){this.x=e,this.y=t}}var c=r(2397),a=r.n(c);function u(e){var{x:t,y:r}=e;return t<40&&(t=40),t>760&&(t=760),r<40&&(r=40),r>760&&(r=760),new d(t,r)}function x(e){let{v:t}=e,{vertexStates:r,edgeStates:s,mouseMode:o,setVertexStates:l}=(0,i.useContext)(k);if(void 0===r.get(t.id))return(0,n.jsx)(n.Fragment,{});let{x:c,y:x}=r.get(t.id).pos;return(0,n.jsx)(a(),{onDrag:(e,n)=>{l(new Map(Array.from(r.entries()).map(e=>{let[i,s]=e;if(i!==t.id)return[i,s];var{x:o,y:l}=n;return{x:o,y:l}=u(new d(o,l)),[i,{...r.get(t.id),pos:new d(o,l)}]})))},onStart:(e,n)=>{let i=new Map(r);i.set(t.id,{...r.get(t.id),heldAt:Date.now()}),l(i)},onStop:(e,n)=>{var i=r.get(t.id).frozen;"freeze"===o.mode&&Date.now()-r.get(t.id).heldAt<100&&10>=new d(n.deltaX,n.deltaY).norm()&&(console.log(r.get(t.id).heldAt,Date.now()),i=!i);let s=new Map(r);s.set(t.id,{...r.get(t.id),heldAt:null,frozen:i}),l(s)},position:{x:c,y:x},children:(0,n.jsxs)("g",{onClick:()=>{"paint"===o.mode&&("vertex-border"===o.subject&&l(new Map(r).set(t.id,{...r.get(t.id),borderColor:o.color})),"vertex-fill"===o.subject&&l(new Map(r).set(t.id,{...r.get(t.id),fillColor:o.color})))},children:[(0,n.jsx)("circle",{r:20,strokeWidth:r.get(t.id).frozen?"4":"2",stroke:r.get(t.id).borderColor,fill:r.get(t.id).fillColor}),(0,n.jsx)("text",{textAnchor:"middle",alignmentBaseline:"middle",className:"select-none",children:null===t.label?t.id:t.label})]})},t.id)}function h(e){var t,r;let{e:s}=e,{vertexStates:o,edgeStates:l,setEdgeStates:d,mouseMode:c}=(0,i.useContext)(k);if(void 0===o.get(s.from)||void 0===o.get(s.to))return(0,n.jsx)(n.Fragment,{});let{x:a,y:u}=o.get(s.from).pos,{x:x,y:h}=o.get(s.to).pos;return(0,n.jsxs)("g",{onClick:()=>{"paint"===c.mode&&"edge"===c.subject&&d(new Map(l).set(s.id,{...l.get(s.id),color:c.color}))},pointerEvents:"all",children:[(0,n.jsx)("line",{x1:a,y1:u,x2:x,y2:h,stroke:"black",visibility:"hidden",strokeWidth:"13"}),(0,n.jsx)("line",{x1:a,y1:u,x2:x,y2:h,stroke:null!==(r=null===(t=l.get(s.id))||void 0===t?void 0:t.color)&&void 0!==r?r:"black",strokeWidth:"2"})]})}function f(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:s,edgeStates:o,setEdgeStates:l}=(0,i.useContext)(k);function c(e,t){return Math.floor(Math.random()*(t-e))+e}(0,i.useEffect)(()=>{let t=setInterval(()=>{!function(e,t,r){let[n,i,s]=[-700,400,200],[o]=[10],[l]=[.5],[c]=[15],[a]=[100],x=new Map;for(let t of e.vertices)x.set(t.id,new d(0,0));for(let r of(new d(400,400),e.vertices)){if(void 0===t.get(r.id))continue;let n=t.get(r.id).pos,s=t.size;for(let d of e.vertices){if(r.id===d.id||void 0===t.get(d.id))continue;let e=t.get(d.id).pos,c=e.sub(n),a=Math.max(o,c.norm()),u=-l*i*i/(a*a),h=c.scaleToLength(u/s);x.set(r.id,x.get(r.id).add(h))}}for(let r of e.edges){if(void 0===t.get(r.from)||void 0===t.get(r.to)||t.get(r.to)===t.get(r.from))continue;let e=t.get(r.from).pos,n=t.get(r.to).pos,i=n.sub(e),s=i.norm(),o=c*(s-a),l=i.scaleToLength(o/s);x.set(r.from,x.get(r.from).add(l)),x.set(r.to,x.get(r.to).sub(l))}let h=new Map;for(let r of e.vertices)if(void 0!==t.get(r.id)){if(null!==t.get(r.id).heldAt||t.get(r.id).frozen){h.set(r.id,t.get(r.id));continue}h.set(r.id,{...t.get(r.id),pos:t.get(r.id).pos.add(x.get(r.id))})}for(let t of e.vertices){if(void 0===h.get(t.id))continue;let e=h.get(t.id);h.set(t.id,{...e,pos:u(e.pos)})}r(h)}(e,r,s)},5);return()=>{clearInterval(t)}},[e,r]);let a=new Map;var f=!1;for(let t of e.vertices)if(r.has(t.id))a.set(t.id,r.get(t.id));else{let e=c(20,780),r=c(20,780);a.set(t.id,{pos:new d(e,r),frozen:!1,heldAt:null,borderColor:"black",fillColor:"white"}),f=!0}return f&&s(a),(0,n.jsxs)("svg",{width:800,height:800,className:"border-solid border-2 m-2 p-2 graph-view-svg",children:[e.edges.map(e=>(0,n.jsx)(h,{e:e},e.id)),e.vertices.map(e=>(0,n.jsx)(x,{v:e},e.id))]})}function p(){let[e,t]=(0,i.useState)("complete"),{graph:r,setGraph:s,vertexStates:o,setVertexStates:l,inputBoxText:d,setInputBoxText:c}=(0,i.useContext)(k),a=e=>{let t=e.match(/[^\d-+]*([-+]?\d+)[^\d-+]*/g).map(e=>parseInt(e));return t},u=t=>{t.preventDefault();var r=d;switch(""===r||r.endsWith("\n")||(r+="\n"),e){case"complete":{let e=a(t.currentTarget.vertices.value);for(let[t,n]of e.entries())for(let[i,s]of e.entries())t<i&&(r+=n+" "+s+"\n")}break;case"complete-bipartite":{let e=a(t.currentTarget.vertices1.value),n=a(t.currentTarget.vertices2.value);for(let t of e)for(let e of n)r+=t+" "+e+"\n"}break;case"cycle":{let e=a(t.currentTarget.vertices.value);for(let[t,n]of e.entries())r+=n+" "+e[(t+1)%e.length]+"\n"}break;case"path":{let e=a(t.currentTarget.vertices.value);for(let[t,n]of e.entries())0!==t&&(r+=e[t-1]+" "+n+"\n")}}c(r)};return(0,n.jsxs)("div",{children:[(()=>{let t=(()=>{switch(e){case"complete":case"cycle":case"path":return(0,n.jsxs)("label",{children:["Vertices",(0,n.jsx)("input",{type:"text",name:"vertices"})]});case"complete-bipartite":return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("label",{children:["Side 1",(0,n.jsx)("input",{type:"text",name:"vertices1"})]}),(0,n.jsxs)("label",{children:["Side 2",(0,n.jsx)("input",{type:"text",name:"vertices2"})]})]})}})();return(0,n.jsxs)("form",{method:"post",onSubmit:u,children:[t,(0,n.jsx)("button",{type:"submit",value:"Submit",children:"Insert"})]})})(),(0,n.jsxs)("label",{children:["Insert subgraph",(0,n.jsxs)("select",{value:e,onChange:e=>t(e.target.value),children:[(0,n.jsx)("option",{value:"complete",children:"Complete"}),(0,n.jsx)("option",{value:"complete-bipartite",children:"Complete bipartite"}),(0,n.jsx)("option",{value:"cycle",children:"Cycle"}),(0,n.jsx)("option",{value:"path",children:"Path"})]})]})]})}function g(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:s}=(0,i.useContext)(k),o=r=>{t({...e,directed:r})};return(0,n.jsxs)(w,{children:[(0,n.jsx)("h2",{children:"Modify"}),(0,n.jsx)(p,{}),(0,n.jsx)("button",{onClick:()=>o(!e.directed),children:"Toggle directed"})]})}function v(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:s}=(0,i.useContext)(k),o=t=>{let n=new Map(r);for(let i of e.vertices)n.set(i.id,{...r.get(i.id),frozen:t});s(n)};return(0,n.jsxs)(w,{children:[(0,n.jsx)("h2",{children:"Arrange"}),(0,n.jsx)("button",{onClick:()=>o(!0),children:"Freeze all"}),(0,n.jsx)("button",{onClick:()=>o(!1),children:"Unfreeze all"})]})}function m(){return(0,n.jsxs)(w,{children:[(0,n.jsx)("h2",{children:"Locate"}),(0,n.jsx)("button",{children:"Vertex"}),(0,n.jsx)("button",{children:"Edge"})]})}function j(){let{setMouseMode:e}=(0,i.useContext)(k);return(0,n.jsxs)(w,{children:[(0,n.jsx)("h2",{children:"Annotate"}),(0,n.jsx)("button",{onClick:()=>e({mode:"paint",subject:"vertex-border",color:"red"}),children:"Paint vertex border"}),(0,n.jsx)("button",{onClick:()=>e({mode:"paint",subject:"vertex-fill",color:"blue"}),children:"Paint vertex fill"}),(0,n.jsx)("button",{onClick:()=>e({mode:"paint",subject:"edge",color:"red"}),children:"Paint edge"})]})}function b(){return(0,n.jsxs)(w,{children:[(0,n.jsx)("h2",{children:"Export"}),(0,n.jsx)("button",{children:"Vertex"}),(0,n.jsx)("button",{children:"Edge"})]})}function w(e){return(0,n.jsx)("div",{className:"border-solid border-2 h-full",children:e.children})}function y(e){let{setMouseMode:t}=(0,i.useContext)(k);return(0,n.jsx)("div",{className:"flex border-solid border-2 justify-between",onClick:()=>t({mode:"freeze"}),children:e.children})}function C(){let[e,t]=(0,i.useState)({type:"modify"}),r=(()=>{switch(e.type){case"modify":return(0,n.jsx)(g,{});case"arrange":return(0,n.jsx)(v,{});case"locate":return(0,n.jsx)(m,{});case"annotate":return(0,n.jsx)(j,{});case"export":return(0,n.jsx)(b,{})}})();return(0,n.jsxs)("div",{className:"w-2/6 h-full m-2 p-2",children:[(0,n.jsxs)(y,{children:[(0,n.jsx)("button",{onClick:()=>t({type:"modify"}),children:"Modify"}),(0,n.jsx)("button",{onClick:()=>t({type:"arrange"}),children:"Arrange"}),(0,n.jsx)("button",{onClick:()=>t({type:"locate"}),children:"Locate"}),(0,n.jsx)("button",{onClick:()=>t({type:"annotate"}),children:"Markup"}),(0,n.jsx)("button",{onClick:()=>t({type:"export"}),children:"Export"})]}),r]})}let k=(0,i.createContext)({graph:{directed:!1,vertices:[],edges:[]},setGraph:()=>{},vertexStates:new Map,setVertexStates:()=>{},edgeStates:new Map,setEdgeStates:()=>{},inputBoxText:"",setInputBoxText:()=>{},mouseMode:{mode:"freeze"},setMouseMode:()=>{},mouseDown:!1,setMouseDown:()=>{}});function M(){let[e,t]=(0,i.useState)("0 1\n0 2\n0 3\n1 3\n"),[r,s]=(0,i.useState)(o(e,!1)),[d,c]=(0,i.useState)(new Map),[a,u]=(0,i.useState)(new Map),[x,h]=(0,i.useState)({mode:"freeze"}),[p,g]=(0,i.useState)(!1);return(0,n.jsx)("main",{children:(0,n.jsx)(k.Provider,{value:{graph:r,setGraph:s,vertexStates:d,setVertexStates:c,inputBoxText:e,setInputBoxText:t,mouseMode:x,setMouseMode:h,mouseDown:p,setMouseDown:g,edgeStates:a,setEdgeStates:u},children:(0,n.jsxs)("div",{className:"flex h-5/6",onMouseDown:()=>g(!0),onMouseUp:()=>g(!1),children:[(0,n.jsx)(l,{}),(0,n.jsx)(f,{}),(0,n.jsx)(C,{}),(0,n.jsx)("h1",{children:p?"yes":"no"})]})})})}function z(){return(0,n.jsx)("main",{children:(0,n.jsx)(M,{})})}}},function(e){e.O(0,[893,971,596,744],function(){return e(e.s=397)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{397:function(e,t,r){Promise.resolve().then(r.bind(r,7810))},7810:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Home}});var n=r(7437),o=r(2265);function addVertexIfNotExist(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e.vertices.find(e=>e.id===t))return e;e.vertices.push({id:t,label:r})}var i=r(1279);let generateGraph=(e,t)=>{let r={directed:t,vertices:[],edges:[]},n=e.split("\n");var o=0;for(let e of n){let matchVertex=()=>{let t=/^\s*(-?\d+)\s*(?::(.*))?\s*$/,n=e.match(t);if(null!==n){console.log(n);let[,e,t]=n;r.vertices.some(t=>t.id===parseInt(e))?function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.vertices.find(e=>e.id===t);void 0!==n&&(n.label=r)}(r,parseInt(e),t):addVertexIfNotExist(r,parseInt(e),t)}},matchEdge=()=>{let t=/^\s*(-?\d+)\s+(-?\d+)\s*$/,n=e.match(t);if(null!==n){var i,s,l;let[,e,t]=n;i=o++,s=parseInt(e),l=parseInt(t),addVertexIfNotExist(r,s),addVertexIfNotExist(r,l),r.edges.push({id:i,from:s,to:l})}};matchVertex(),matchEdge()}return r};function TextEditor(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:s,inputBoxText:l,setInputBoxText:a}=(0,o.useContext)(u),[d,c]=(0,o.useState)(!1);(0,o.useEffect)(()=>{t(generateGraph(l,e.directed))},[l]);let onChange=r=>{l!==r.target.value&&(a(r.target.value),t(generateGraph(r.target.value,e.directed)))};return(0,n.jsxs)("div",{className:"h-[80vh] m-2 flex flex-col",children:[(0,n.jsxs)("div",{onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},children:["Input: ",(0,n.jsx)(i.G,{icon:"question-circle",className:"max-h-6 max-w-6"}),d?(0,n.jsxs)("p",{className:"fixed bg-black color rounded-lg text-white px-2",children:["lone vertex - id ",(0,n.jsx)("br",{}),"labeled vertex - id: label ",(0,n.jsx)("br",{}),"edge - id1 id2 ",(0,n.jsx)("br",{})]}):null]}),(0,n.jsx)("div",{className:"grow ",children:(0,n.jsx)("textarea",{className:"border-2 border-solid resize-none h-full",value:l,onChange:e=>onChange(e)})})]})}let Vector=class Vector{add(e){return Vector.add(this,e)}sub(e){return Vector.sub(this,e)}norm(){return Vector.norm(this)}scale(e){return Vector.scale(this,e)}normalize(){return Vector.normalize(this)}scaleToLength(e){return Vector.scaleToLength(this,e)}static add(e,t){return new Vector(e.x+t.x,e.y+t.y)}static sub(e,t){return new Vector(e.x-t.x,e.y-t.y)}static norm(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static scale(e,t){return new Vector(e.x*t,e.y*t)}static normalize(e){return 1e-9>=e.norm()?new Vector(0,0):Vector.scale(e,1/Vector.norm(e))}static scaleToLength(e,t){return Vector.scale(Vector.normalize(e),t)}constructor(e,t){this.x=e,this.y=t}};var s=r(2397),l=r.n(s);function placeInBounds(e,t){var{x:r,y:n}=e;return r<40&&(r=40),r>t-40&&(r=t-40),n<40&&(n=40),n>t-40&&(n=t-40),new Vector(r,n)}function VertexView(e){let{v:t}=e,{vertexStates:r,edgeStates:i,mouseMode:s,setVertexStates:a,mouseDown:d,windowHeight:c}=(0,o.useContext)(u),m=.8*c;if(void 0===r.get(t.id))return(0,n.jsx)(n.Fragment,{});let{x:x,y:h}=r.get(t.id).pos;return(0,n.jsx)(l(),{onDrag:(e,n)=>{a(new Map(Array.from(r.entries()).map(e=>{let[o,i]=e;if(o!==t.id)return[o,i];var{x:s,y:l}=n;return{x:s,y:l}=placeInBounds(new Vector(s,l),m),[o,{...r.get(t.id),pos:new Vector(s,l)}]})))},onStart:(e,n)=>{let o=new Map(r);o.set(t.id,{...r.get(t.id),heldAt:Date.now()}),a(o)},onStop:(e,n)=>{var o=r.get(t.id).frozen;"freeze"===s.mode&&Date.now()-r.get(t.id).heldAt<100&&10>=new Vector(n.deltaX,n.deltaY).norm()&&(console.log(r.get(t.id).heldAt,Date.now()),o=!o);let i=new Map(r);i.set(t.id,{...r.get(t.id),heldAt:null,frozen:o}),a(i)},position:{x:x,y:h},children:(0,n.jsxs)("g",{onClick:()=>{"paint"===s.mode&&("vertex-border"===s.subject&&a(new Map(r).set(t.id,{...r.get(t.id),borderColor:s.color})),"vertex-fill"===s.subject&&a(new Map(r).set(t.id,{...r.get(t.id),fillColor:s.color})))},onMouseEnter:()=>{"paint"===s.mode&&"vertex-border"===s.subject&&d&&a(new Map(r).set(t.id,{...r.get(t.id),borderColor:s.color})),"paint"===s.mode&&"vertex-fill"===s.subject&&d&&a(new Map(r).set(t.id,{...r.get(t.id),fillColor:s.color}))},children:[(0,n.jsx)("circle",{r:20,strokeWidth:r.get(t.id).frozen?"4":"2",stroke:r.get(t.id).borderColor,fill:r.get(t.id).fillColor}),(0,n.jsx)("text",{textAnchor:"middle",alignmentBaseline:"middle",className:"select-none",children:null===t.label?t.id:t.label})]})},t.id)}function EdgeView(e){var t,r;let{e:i}=e,{vertexStates:s,edgeStates:l,setEdgeStates:a,mouseMode:d,mouseDown:c}=(0,o.useContext)(u);if(void 0===s.get(i.from)||void 0===s.get(i.to))return(0,n.jsx)(n.Fragment,{});let{x:m,y:x}=s.get(i.from).pos,{x:h,y:g}=s.get(i.to).pos;return(0,n.jsxs)("g",{onMouseEnter:()=>{"paint"===d.mode&&"edge"===d.subject&&c&&a(new Map(l).set(i.id,{...l.get(i.id),color:d.color}))},onClick:()=>{"paint"===d.mode&&"edge"===d.subject&&a(new Map(l).set(i.id,{...l.get(i.id),color:d.color}))},pointerEvents:"all",children:[(0,n.jsx)("line",{x1:m,y1:x,x2:h,y2:g,stroke:"black",visibility:"hidden",strokeWidth:"13"}),(0,n.jsx)("line",{x1:m,y1:x,x2:h,y2:g,stroke:null!==(r=null===(t=l.get(i.id))||void 0===t?void 0:t.color)&&void 0!==r?r:"black",strokeWidth:"2"})]})}function GraphViewer(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:i,edgeStates:s,setEdgeStates:l,windowHeight:a}=(0,o.useContext)(u),d=.8*a;function randInt(e,t){return Math.floor(Math.random()*(t-e))+e}(0,o.useEffect)(()=>{let t=setInterval(()=>{!function(e,t,r,n){let[o,i,s]=[-700,400,200],[l]=[10],[a]=[.5],[d]=[15],[c]=[100],u=new Map;for(let t of e.vertices)u.set(t.id,new Vector(0,0));for(let r of(new Vector(n/2,n/2),e.vertices)){if(void 0===t.get(r.id))continue;let n=t.get(r.id).pos,o=t.size;for(let s of e.vertices){if(r.id===s.id||void 0===t.get(s.id))continue;let e=t.get(s.id).pos,d=e.sub(n),c=Math.max(l,d.norm()),m=-a*i*i/(c*c),x=d.scaleToLength(m/o);u.set(r.id,u.get(r.id).add(x))}}for(let r of e.edges){if(void 0===t.get(r.from)||void 0===t.get(r.to)||t.get(r.to)===t.get(r.from))continue;let e=t.get(r.from).pos,n=t.get(r.to).pos,o=n.sub(e),i=o.norm(),s=d*(i-c),l=o.scaleToLength(s/i);u.set(r.from,u.get(r.from).add(l)),u.set(r.to,u.get(r.to).sub(l))}let m=new Map;for(let r of e.vertices)if(void 0!==t.get(r.id)){if(null!==t.get(r.id).heldAt||t.get(r.id).frozen){m.set(r.id,t.get(r.id));continue}m.set(r.id,{...t.get(r.id),pos:t.get(r.id).pos.add(u.get(r.id))})}for(let t of e.vertices){if(void 0===m.get(t.id))continue;let e=m.get(t.id);m.set(t.id,{...e,pos:placeInBounds(e.pos,n)})}r(m)}(e,r,i,d)},5);return()=>{clearInterval(t)}},[e,r,d,i]);let c=new Map;var m=!1;for(let t of e.vertices)if(r.has(t.id)&&!Number.isNaN(r.get(t.id).pos.x))c.set(t.id,r.get(t.id));else{let e=randInt(20,d-20),r=randInt(20,d-20);c.set(t.id,{pos:new Vector(e,r),frozen:!1,heldAt:null,borderColor:"black",fillColor:"white"}),m=!0}return m&&i(c),(0,n.jsxs)("svg",{width:d,height:d,className:"border-solid border-2 m-2 p-2 graph-view-svg",id:"graph-view-svg",children:[e.edges.map(e=>(0,n.jsx)(EdgeView,{e:e},e.id)),e.vertices.map(e=>(0,n.jsx)(VertexView,{v:e},e.id))]})}var a=r(9119);function InsertSubgraphPanel(){let[e,t]=(0,o.useState)("complete"),{graph:r,setGraph:i,vertexStates:s,setVertexStates:l,inputBoxText:a,setInputBoxText:d}=(0,o.useContext)(u),parseIntoList=e=>{let t=e.match(/[^\d-+]*([-+]?\d+)[^\d-+]*/g).map(e=>parseInt(e));return t},handleSubmit=t=>{t.preventDefault();var r=a;switch(""===r||r.endsWith("\n")||(r+="\n"),e){case"complete":{let e=parseIntoList(t.currentTarget.vertices.value);for(let[t,n]of e.entries())for(let[o,i]of e.entries())t<o&&(r+=n+" "+i+"\n")}break;case"complete-bipartite":{let e=parseIntoList(t.currentTarget.vertices1.value),n=parseIntoList(t.currentTarget.vertices2.value);for(let t of e)for(let e of n)r+=t+" "+e+"\n"}break;case"cycle":{let e=parseIntoList(t.currentTarget.vertices.value);for(let[t,n]of e.entries())r+=n+" "+e[(t+1)%e.length]+"\n"}break;case"path":{let e=parseIntoList(t.currentTarget.vertices.value);for(let[t,n]of e.entries())0!==t&&(r+=e[t-1]+" "+n+"\n")}}d(r)};return(0,n.jsxs)("div",{children:[(()=>{let t=(()=>{switch(e){case"complete":case"cycle":case"path":return(0,n.jsxs)("label",{children:["Vertices",(0,n.jsx)("input",{type:"text",name:"vertices"})]});case"complete-bipartite":return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("label",{children:["Side 1",(0,n.jsx)("input",{type:"text",name:"vertices1"})]}),(0,n.jsxs)("label",{children:["Side 2",(0,n.jsx)("input",{type:"text",name:"vertices2"})]})]})}})();return(0,n.jsxs)("form",{method:"post",onSubmit:handleSubmit,children:[t,(0,n.jsx)("button",{type:"submit",value:"Submit",children:"Insert"})]})})(),(0,n.jsxs)("label",{children:["Insert subgraph",(0,n.jsxs)("select",{value:e,onChange:e=>t(e.target.value),children:[(0,n.jsx)("option",{value:"complete",children:"Complete"}),(0,n.jsx)("option",{value:"complete-bipartite",children:"Complete bipartite"}),(0,n.jsx)("option",{value:"cycle",children:"Cycle"}),(0,n.jsx)("option",{value:"path",children:"Path"})]})]})]})}function ModifyCommandPanel(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:i}=(0,o.useContext)(u),setDirected=r=>{t({...e,directed:r})};return(0,n.jsxs)(CommandPanel,{children:[(0,n.jsx)(InsertSubgraphPanel,{}),(0,n.jsx)("button",{onClick:()=>setDirected(!e.directed),children:"Toggle directed"})]})}function ArrangeCommandPanel(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:i}=(0,o.useContext)(u),setFreeze=t=>{let n=new Map(r);for(let o of e.vertices)n.set(o.id,{...r.get(o.id),frozen:t});i(n)};return(0,n.jsxs)(CommandPanel,{children:[(0,n.jsx)("button",{onClick:()=>setFreeze(!0),children:"Freeze all"}),(0,n.jsx)("button",{onClick:()=>setFreeze(!1),children:"Unfreeze all"})]})}function LocateCommandPanel(){return(0,n.jsx)(CommandPanel,{children:(0,n.jsx)("p",{children:"wip"})})}function PaintCommandPanel(){let{mouseMode:e,setMouseMode:t}=(0,o.useContext)(u),[r,i]=(0,o.useState)({r:255,g:0,b:0,a:1}),[s,l]=(0,o.useState)(!1),getColor=()=>"rgba(".concat(r.r,", ").concat(r.g,", ").concat(r.b,", ").concat(r.a,")");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-8 h-8 rounded-full border-2",onClick:()=>{l(!s)},style:{background:getColor()}}),s?(0,n.jsx)(a.AI,{onChange:r=>{i(r.rgb),"paint"===e.mode&&t({mode:"paint",subject:e.subject,color:getColor()})},color:r,className:"fixed"}):null,(0,n.jsx)("button",{onClick:()=>t({mode:"paint",subject:"vertex-border",color:getColor()}),children:"Paint vertex border"}),(0,n.jsx)("button",{onClick:()=>t({mode:"paint",subject:"vertex-fill",color:getColor()}),children:"Paint vertex fill"}),(0,n.jsx)("button",{onClick:()=>t({mode:"paint",subject:"edge",color:getColor()}),children:"Paint edge"})]})}function AnnotateCommandPanel(){return(0,n.jsx)(CommandPanel,{children:(0,n.jsx)(PaintCommandPanel,{})})}function ExportCommandPanel(){return(0,n.jsx)(CommandPanel,{children:(0,n.jsx)("button",{onClick:()=>{let e=document.getElementById("graph-view-svg");if(null===e)return;let t=new XMLSerializer().serializeToString(e),r=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),n=URL.createObjectURL(r),o=document.createElement("a");o.href=n,o.download="graph.svg",document.body.appendChild(o),o.click(),document.body.removeChild(o)},children:"Download SVG"})})}function CommandPanel(e){return(0,n.jsx)("div",{className:"border-solid border-2 h-full",children:e.children})}function CommandBar(e){let{setMouseMode:t}=(0,o.useContext)(u);return(0,n.jsx)("div",{className:"flex border-solid border-2 justify-between",onClick:()=>t({mode:"freeze"}),children:e.children})}function CommandMenu(){let[e,t]=(0,o.useState)({type:"modify"}),r=(()=>{switch(e.type){case"modify":return(0,n.jsx)(ModifyCommandPanel,{});case"arrange":return(0,n.jsx)(ArrangeCommandPanel,{});case"locate":return(0,n.jsx)(LocateCommandPanel,{});case"annotate":return(0,n.jsx)(AnnotateCommandPanel,{});case"export":return(0,n.jsx)(ExportCommandPanel,{})}})(),style=t=>{var r="grow basis-0 ";return e.type===t?r+="bg-gray-200":r+="hover:bg-gray-100 active:bg-gray-200",r};return(0,n.jsxs)("div",{className:"w-2/6 h-full m-2 p-2",children:[(0,n.jsxs)(CommandBar,{children:[(0,n.jsx)("button",{onClick:()=>t({type:"modify"}),className:style("modify"),children:"Modify"}),(0,n.jsx)("button",{onClick:()=>t({type:"arrange"}),className:style("arrange"),children:"Arrange"}),(0,n.jsx)("button",{onClick:()=>t({type:"locate"}),className:style("locate"),children:"Locate"}),(0,n.jsx)("button",{onClick:()=>t({type:"annotate"}),className:style("annotate"),children:"Annotate"}),(0,n.jsx)("button",{onClick:()=>t({type:"export"}),className:style("export"),children:"Export"})]}),r]})}var d=r(1988),c=r(2759);d.vI.add(c.Fuz);let u=(0,o.createContext)({graph:{directed:!1,vertices:[],edges:[]},setGraph:()=>{},vertexStates:new Map,setVertexStates:()=>{},edgeStates:new Map,setEdgeStates:()=>{},inputBoxText:"",setInputBoxText:()=>{},mouseMode:{mode:"freeze"},setMouseMode:()=>{},mouseDown:!1,setMouseDown:()=>{},windowHeight:0});function GraphVisualizer(){let[e,t]=(0,o.useState)("0 1\n0 2\n0 3\n1 3\n"),[r,i]=(0,o.useState)(generateGraph(e,!1)),[s,l]=(0,o.useState)(new Map),[a,d]=(0,o.useState)(new Map),[c,m]=(0,o.useState)({mode:"freeze"}),[x,h]=(0,o.useState)(!1),[g,p]=(0,o.useState)(1600);return(0,o.useLayoutEffect)(()=>{p(window.innerHeight)},[]),(0,o.useEffect)(()=>{let handleResize=()=>{p(window.innerHeight)};return window.addEventListener("resize",handleResize),()=>window.removeEventListener("resize",handleResize)},[]),(0,n.jsx)("main",{children:(0,n.jsx)(u.Provider,{value:{graph:r,setGraph:i,vertexStates:s,setVertexStates:l,inputBoxText:e,setInputBoxText:t,mouseMode:c,setMouseMode:m,mouseDown:x,setMouseDown:h,edgeStates:a,setEdgeStates:d,windowHeight:g},children:(0,n.jsx)("div",{className:"h-screen w-screen",children:(0,n.jsxs)("div",{className:"flex h-5/6 m-auto",onMouseDown:()=>h(!0),onMouseUp:()=>h(!1),children:[(0,n.jsx)(TextEditor,{}),(0,n.jsx)(GraphViewer,{}),(0,n.jsx)(CommandMenu,{}),(0,n.jsx)("h1",{children:x?"yes":"no"})]})})})})}function Home(){return(0,n.jsx)("main",{children:(0,n.jsx)(GraphVisualizer,{})})}}},function(e){e.O(0,[676,425,971,864,744],function(){return e(e.s=397)}),_N_E=e.O()}]);
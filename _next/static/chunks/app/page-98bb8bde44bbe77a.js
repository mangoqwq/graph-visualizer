(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{397:function(e,t,r){Promise.resolve().then(r.bind(r,5674))},5674:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return M}});var n=r(7437),s=r(2265);function i(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e.vertices.find(e=>e.id===t))return e;e.vertices.push({id:t,label:r})}function l(e,t,r,n){i(e,t),i(e,r),e.edges.push({from:t,to:r,directed:n})}function o(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:o,inputBoxText:c,setInputBoxText:d}=(0,s.useContext)(k),a=r=>{let n={directed:e.directed,vertices:[],edges:[]},s=r.split("\n");for(let e of s){let t=()=>{let t=/^\s*(-?\d+)\s*(?::(.*))?\s*$/,r=e.match(t);if(null!==r){console.log(r);let[,e,t]=r;n.vertices.some(t=>t.id===parseInt(e))?function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.vertices.find(e=>e.id===t);void 0!==n&&(n.label=r)}(n,parseInt(e),t):i(n,parseInt(e),t)}},r=()=>{let t=/^\s*(-?\d+)\s+(-?\d+)\s*$/,r=e.match(t);if(null!==r){let[,e,t]=r;l(n,parseInt(e),parseInt(t),!1),console.log(e,t)}};t(),r()}n!==e&&t(n)};(0,s.useEffect)(()=>{a(c)},[c]);let u=e=>{c!==e.target.value&&(d(e.target.value),a(e.target.value))};return(0,n.jsx)("div",{className:"h-[80vh]",children:(0,n.jsx)("textarea",{className:"border-solid border-2 resize-none h-full m-2 p-2",value:c,onChange:e=>u(e)})})}class c{add(e){return c.add(this,e)}sub(e){return c.sub(this,e)}norm(){return c.norm(this)}scale(e){return c.scale(this,e)}normalize(){return c.normalize(this)}scaleToLength(e){return c.scaleToLength(this,e)}static add(e,t){return new c(e.x+t.x,e.y+t.y)}static sub(e,t){return new c(e.x-t.x,e.y-t.y)}static norm(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static scale(e,t){return new c(e.x*t,e.y*t)}static normalize(e){return 1e-9>=e.norm()?new c(0,0):c.scale(e,1/c.norm(e))}static scaleToLength(e,t){return c.scale(c.normalize(e),t)}constructor(e,t){this.x=e,this.y=t}}var d=r(2397),a=r.n(d);function u(e){var{x:t,y:r}=e;return t<40&&(t=40),t>760&&(t=760),r<40&&(r=40),r>760&&(r=760),new c(t,r)}function h(e){let{v:t,vertexStates:r,setVertexStates:s}=e;if(void 0===r.get(t.id))return(0,n.jsx)(n.Fragment,{});let{x:i,y:l}=r.get(t.id).pos;return(0,n.jsx)(a(),{onDrag:(e,n)=>{s(new Map(Array.from(r.entries()).map(e=>{let[s,i]=e;if(s!==t.id)return[s,i];var{x:l,y:o}=n;return{x:l,y:o}=u(new c(l,o)),[s,{...r.get(t.id),pos:new c(l,o)}]})))},onStart:(e,n)=>{let i=new Map(r);i.set(t.id,{...r.get(t.id),heldAt:Date.now()}),s(i)},onStop:(e,n)=>{var i=r.get(t.id).frozen;Date.now()-r.get(t.id).heldAt<100&&10>=new c(n.deltaX,n.deltaY).norm()&&(console.log(r.get(t.id).heldAt,Date.now()),i=!i);let l=new Map(r);l.set(t.id,{...r.get(t.id),heldAt:null,frozen:i}),s(l)},position:{x:i,y:l},children:(0,n.jsxs)("g",{children:[(0,n.jsx)("circle",{r:20,strokeWidth:r.get(t.id).frozen?"4":"2",stroke:"black",fill:"white"}),(0,n.jsx)("text",{textAnchor:"middle",alignmentBaseline:"middle",className:"select-none",children:null===t.label?t.id:t.label})]})},t.id)}function x(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:i}=(0,s.useContext)(k);function l(e,t){return Math.floor(Math.random()*(t-e))+e}(0,s.useEffect)(()=>{let t=setInterval(()=>{!function(e,t,r){let[n,s,i]=[-700,400,200],[l]=[10],[o]=[.5],[d]=[15],[a]=[100],h=new Map;for(let t of e.vertices)h.set(t.id,new c(0,0));for(let r of(new c(400,400),e.vertices)){if(void 0===t.get(r.id))continue;let n=t.get(r.id).pos,i=t.size;for(let c of e.vertices){if(r.id===c.id||void 0===t.get(c.id))continue;let e=t.get(c.id).pos,d=e.sub(n),a=Math.max(l,d.norm()),u=-o*s*s/(a*a),x=d.scaleToLength(u/i);h.set(r.id,h.get(r.id).add(x))}}for(let r of e.edges){if(void 0===t.get(r.from)||void 0===t.get(r.to)||t.get(r.to)===t.get(r.from))continue;let e=t.get(r.from).pos,n=t.get(r.to).pos,s=n.sub(e),i=s.norm(),l=d*(i-a),o=s.scaleToLength(l/i);h.set(r.from,h.get(r.from).add(o)),h.set(r.to,h.get(r.to).sub(o))}let x=new Map;for(let r of e.vertices)if(void 0!==t.get(r.id)){if(null!==t.get(r.id).heldAt||t.get(r.id).frozen){x.set(r.id,t.get(r.id));continue}x.set(r.id,{...t.get(r.id),pos:t.get(r.id).pos.add(h.get(r.id))})}for(let t of e.vertices){if(void 0===x.get(t.id))continue;let e=x.get(t.id);x.set(t.id,{...e,pos:u(e.pos)})}r(x)}(e,r,i)},5);return()=>{clearInterval(t)}},[e,r]);let o=new Map;var d=!1;for(let t of e.vertices)if(r.has(t.id))o.set(t.id,r.get(t.id));else{let e=l(20,780),r=l(20,780);o.set(t.id,{pos:new c(e,r),frozen:!1,heldAt:null}),d=!0}return d&&i(o),(0,n.jsxs)("svg",{width:800,height:800,className:"border-solid border-2 m-2 p-2 graph-view-svg",children:[e.edges.map(t=>{if(void 0===r.get(t.from)||void 0===r.get(t.to))return(0,n.jsx)(n.Fragment,{});let{x:s,y:i}=r.get(t.from).pos,{x:l,y:o}=r.get(t.to).pos;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("line",{x1:s,y1:i,x2:l,y2:o,stroke:e.directed?"blue":"black",strokeWidth:"2"})})}),e.vertices.map(e=>(0,n.jsx)(h,{v:e,vertexStates:r,setVertexStates:i},e.id))]})}function f(){let[e,t]=(0,s.useState)("complete"),{graph:r,setGraph:i,vertexStates:l,setVertexStates:o,inputBoxText:c,setInputBoxText:d}=(0,s.useContext)(k),a=e=>{let t=e.match(/[^\d-+]*([-+]?\d+)[^\d-+]*/g).map(e=>parseInt(e));return t},u=t=>{t.preventDefault();var r=c;switch(""===r||r.endsWith("\n")||(r+="\n"),e){case"complete":{let e=a(t.currentTarget.vertices.value);for(let[t,n]of e.entries())for(let[s,i]of e.entries())t<s&&(r+=n+" "+i+"\n")}break;case"complete-bipartite":{let e=a(t.currentTarget.vertices1.value),n=a(t.currentTarget.vertices2.value);for(let t of e)for(let e of n)r+=t+" "+e+"\n"}break;case"cycle":{let e=a(t.currentTarget.vertices.value);for(let[t,n]of e.entries())r+=n+" "+e[(t+1)%e.length]+"\n"}break;case"path":{let e=a(t.currentTarget.vertices.value);for(let[t,n]of e.entries())0!==t&&(r+=e[t-1]+" "+n+"\n")}}d(r)};return(0,n.jsxs)("div",{children:[(()=>{let t=(()=>{switch(e){case"complete":case"cycle":case"path":return(0,n.jsxs)("label",{children:["Vertices",(0,n.jsx)("input",{type:"text",name:"vertices"})]});case"complete-bipartite":return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("label",{children:["Side 1",(0,n.jsx)("input",{type:"text",name:"vertices1"})]}),(0,n.jsxs)("label",{children:["Side 2",(0,n.jsx)("input",{type:"text",name:"vertices2"})]})]})}})();return(0,n.jsxs)("form",{method:"post",onSubmit:u,children:[t,(0,n.jsx)("button",{type:"submit",value:"Submit",children:"Insert"})]})})(),(0,n.jsxs)("label",{children:["Insert subgraph",(0,n.jsxs)("select",{value:e,onChange:e=>t(e.target.value),children:[(0,n.jsx)("option",{value:"complete",children:"Complete"}),(0,n.jsx)("option",{value:"complete-bipartite",children:"Complete bipartite"}),(0,n.jsx)("option",{value:"cycle",children:"Cycle"}),(0,n.jsx)("option",{value:"path",children:"Path"})]})]})]})}function p(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:i}=(0,s.useContext)(k),l=r=>{t({...e,directed:r})};return(0,n.jsxs)(b,{children:[(0,n.jsx)("h2",{children:"Modify"}),(0,n.jsx)(f,{}),(0,n.jsx)("button",{onClick:()=>l(!e.directed),children:"Toggle directed"})]})}function g(){let{graph:e,setGraph:t,vertexStates:r,setVertexStates:i}=(0,s.useContext)(k),l=t=>{let n=new Map(r);for(let s of e.vertices)n.set(s.id,{...r.get(s.id),frozen:t});i(n)};return(0,n.jsxs)(b,{children:[(0,n.jsx)("h2",{children:"Arrange"}),(0,n.jsx)("button",{onClick:()=>l(!0),children:"Freeze all"}),(0,n.jsx)("button",{onClick:()=>l(!1),children:"Unfreeze all"})]})}function v(){return(0,n.jsxs)(b,{children:[(0,n.jsx)("h2",{children:"Locate"}),(0,n.jsx)("button",{children:"Vertex"}),(0,n.jsx)("button",{children:"Edge"})]})}function m(){return(0,n.jsxs)(b,{children:[(0,n.jsx)("h2",{children:"Markup"}),(0,n.jsx)("button",{children:"Vertex"}),(0,n.jsx)("button",{children:"Edge"})]})}function j(){return(0,n.jsxs)(b,{children:[(0,n.jsx)("h2",{children:"Export"}),(0,n.jsx)("button",{children:"Vertex"}),(0,n.jsx)("button",{children:"Edge"})]})}function b(e){return(0,n.jsx)("div",{className:"border-solid border-2 h-full",children:e.children})}function y(e){return(0,n.jsx)("div",{className:"flex border-solid border-2 justify-between",children:e.children})}function w(){let[e,t]=(0,s.useState)({type:"modify"}),r=(()=>{switch(e.type){case"modify":return(0,n.jsx)(p,{});case"arrange":return(0,n.jsx)(g,{});case"locate":return(0,n.jsx)(v,{});case"markup":return(0,n.jsx)(m,{});case"export":return(0,n.jsx)(j,{})}})();return(0,n.jsxs)("div",{className:"w-2/6 h-full m-2 p-2",children:[(0,n.jsxs)(y,{children:[(0,n.jsx)("button",{onClick:()=>t({type:"modify"}),children:"Modify"}),(0,n.jsx)("button",{onClick:()=>t({type:"arrange"}),children:"Arrange"}),(0,n.jsx)("button",{onClick:()=>t({type:"locate"}),children:"Locate"}),(0,n.jsx)("button",{onClick:()=>t({type:"markup"}),children:"Markup"}),(0,n.jsx)("button",{onClick:()=>t({type:"export"}),children:"Export"})]}),r]})}let k=(0,s.createContext)({graph:{directed:!1,vertices:[],edges:[]},setGraph:()=>{},vertexStates:new Map,setVertexStates:()=>{},inputBoxText:"",setInputBoxText:()=>{}});function C(){let[e,t]=(0,s.useState)(function(){let e={directed:!1,vertices:[],edges:[]};return l(e,0,1,!1),l(e,0,2,!1),l(e,0,3,!1),l(e,1,3,!1),e}()),[r,i]=(0,s.useState)(new Map),[c,d]=(0,s.useState)(e.edges.map(e=>e.from+" "+e.to).join("\n"));return(0,n.jsx)("main",{children:(0,n.jsx)(k.Provider,{value:{graph:e,setGraph:t,vertexStates:r,setVertexStates:i,inputBoxText:c,setInputBoxText:d},children:(0,n.jsxs)("div",{className:"flex h-5/6",children:[(0,n.jsx)(o,{}),(0,n.jsx)(x,{}),(0,n.jsx)(w,{})]})})})}function M(){return(0,n.jsx)("main",{children:(0,n.jsx)(C,{})})}}},function(e){e.O(0,[893,971,596,744],function(){return e(e.s=397)}),_N_E=e.O()}]);